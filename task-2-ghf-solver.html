
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Task 2: General Hartree-Fock solver &#8212; FYS4411 - Project 2 TDHF</title>
    
  <link rel="stylesheet" href="_static/css/index.f658d18f9b420779cfdf24aa0a7e2d77.css">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/sphinx-book-theme.e7340bb3dbd8dde6db86f25597f54a1b.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.d3f166471bb80abb5163.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.7d483ff0a819d6edff12ce0b1ead3928.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Markdown Files" href="markdown.html" />
    <link rel="prev" title="Task 1: Single-particle basis" href="task-1-single-particle-basis.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  <img src="_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">FYS4411 - Project 2 TDHF</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   Time-dependent Hartree-Fock theory
  </a>
 </li>
</ul>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="task-1-single-particle-basis.html">
   Task 1: Single-particle basis
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Task 2: General Hartree-Fock solver
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="markdown.html">
   Markdown Files
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks.html">
   Content with notebooks
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/task-2-ghf-solver.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/Schoyen/tdhf-project-fys4411"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/Schoyen/tdhf-project-fys4411/issues/new?title=Issue%20on%20page%20%2Ftask-2-ghf-solver.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>


            <!-- Full screen (wrap in <a> to have style consistency -->
            <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                    data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                    title="Fullscreen mode"><i
                        class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/Schoyen/tdhf-project-fys4411/master?urlpath=tree/docs/task-2-ghf-solver.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i>
            Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#types-of-orbital-systems">
   Types of orbital systems
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#adding-spin-to-the-harmonic-oscillator-basis">
   Adding spin to the harmonic oscillator basis
  </a>
 </li>
</ul>

        </nav>
        
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="task-2-general-hartree-fock-solver">
<h1>Task 2: General Hartree-Fock solver<a class="headerlink" href="#task-2-general-hartree-fock-solver" title="Permalink to this headline">¶</a></h1>
<p>Having set up an initial single-particle basis set <span class="math notranslate nohighlight">\(\{\chi_{\alpha}\}_{\alpha = 1}^{l}\)</span> we now set out to find the ground state of the two-body problem.
The full Hamiltonian used by <span id="id1">[<a class="reference internal" href="intro.html#id3"><span>ZKBS04</span></a>]</span> is given by</p>
<div class="amsmath math notranslate nohighlight" id="equation-9ab0e614-9d56-477e-bedc-9d1816b49db7">
<span class="eqno">(5)<a class="headerlink" href="#equation-9ab0e614-9d56-477e-bedc-9d1816b49db7" title="Permalink to this equation">¶</a></span>\[\begin{align}
    \hat{H}
    = \hat{h} + \hat{u}
    = \sum_{i = 1}^{n}\left(
        -\frac{1}{2}\frac{\text{d}^2}{\text{d}x^2}
        + \frac{1}{2}\omega^2 x^2
    \right)
    + \sum_{i = 1}^{n} \sum_{j = i + 1}^{n} \frac{\alpha}{\sqrt{(x_i - x_j)^2 + a^2}},
\end{align}\]</div>
<p>where the number of particles <span class="math notranslate nohighlight">\(n = 2\)</span>, <span class="math notranslate nohighlight">\(a = 0.25\)</span>, <span class="math notranslate nohighlight">\(\alpha = 1\)</span> (not to be confused with the index <span class="math notranslate nohighlight">\(\alpha\)</span> in the basis of harmonic oscillator eigenstates), and <span class="math notranslate nohighlight">\(\omega = 0.25\)</span>.</p>
<div class="section" id="types-of-orbital-systems">
<h2>Types of orbital systems<a class="headerlink" href="#types-of-orbital-systems" title="Permalink to this headline">¶</a></h2>
<p>In quantum chemistry it is common to call the initial single-particle functions for <em>atomic orbitals</em> (AO).
We will also adhere to this convention, thus making the basis of harmonic oscillator single-particle functions the atomic orbitals of our system.
Now, as the harmonic oscillator Hamiltonian is independent of spin we have restricted our view to the spatial part of the atomic orbitals when using quantum-systems to construct our basis elements.
However, when moving to the full fermionic many-body picture (two = many) we have to include spin to get the full picture.
We often talk about three kinds of orbitals depending on the restrictions put on spin.</p>
<ol>
<li><p>The general spin-orbital is on the form</p>
<div class="amsmath math notranslate nohighlight" id="equation-097bfc93-0a07-4a91-8868-47856203a660">
<span class="eqno">(6)<a class="headerlink" href="#equation-097bfc93-0a07-4a91-8868-47856203a660" title="Permalink to this equation">¶</a></span>\[\begin{align}
        \phi(x, m_s)
        &amp;= c_1 \varphi_1(x) \alpha(m_s) + c_2 \varphi_2(x) \beta(m_s),
    \end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(\varphi_i(x)\)</span> are the spatial oribtals, and <span class="math notranslate nohighlight">\(\sigma \in \{\alpha, \beta\}\)</span> are spin basis functions with <span class="math notranslate nohighlight">\(m_s \in \{\uparrow, \downarrow\}\)</span> the spin quantum number.
Typical choices for the spin basis functions are</p>
<div class="amsmath math notranslate nohighlight" id="equation-9918cf5f-f526-4f6e-9c7c-ff4b1d9ae24a">
<span class="eqno">(7)<a class="headerlink" href="#equation-9918cf5f-f526-4f6e-9c7c-ff4b1d9ae24a" title="Permalink to this equation">¶</a></span>\[\begin{gather}
        \alpha(\uparrow) = 1, \quad \beta(\uparrow) = 0, \\
        \alpha(\downarrow) = 0, \quad \beta(\downarrow) = 1.
    \end{gather}\]</div>
</li>
<li><p>The unrestricted spin-orbital is on the form</p>
<div class="amsmath math notranslate nohighlight" id="equation-2c9af0db-1989-4112-9fba-6ccc8ab4b706">
<span class="eqno">(8)<a class="headerlink" href="#equation-2c9af0db-1989-4112-9fba-6ccc8ab4b706" title="Permalink to this equation">¶</a></span>\[\begin{align}
        \phi(x, m_s)
        = \varphi_{\sigma}(x) \sigma(m_s),
    \end{align}\]</div>
<p>where an unrestricted spin-orbital has a definite spin-direction (either <span class="math notranslate nohighlight">\(\alpha\)</span> or <span class="math notranslate nohighlight">\(\beta\)</span>), but allows for the spatial part to be different between spin-directions.</p>
</li>
<li><p>The restricted spin-orbital is on the form</p>
<div class="amsmath math notranslate nohighlight" id="equation-202c92e2-a7ca-415a-8749-98779aca77a6">
<span class="eqno">(9)<a class="headerlink" href="#equation-202c92e2-a7ca-415a-8749-98779aca77a6" title="Permalink to this equation">¶</a></span>\[\begin{align}
        \phi(x, m_s)
        = \varphi(x) \sigma(m_s),
    \end{align}\]</div>
<p>where the spin-orbitals have a definite spin-direction with the spatial part equal between the two spin-directions.</p>
</li>
</ol>
<p>We will in this project create a general Hartree-Fock (GHF) solver which implies that we use general spin-orbitals.
This will turn out to be easiest mathematically (when deriving the equations for GHF) and the most general formulation.
However, the restricted and unrestricted formulations are more numerically efficient.</p>
</div>
<div class="section" id="adding-spin-to-the-harmonic-oscillator-basis">
<h2>Adding spin to the harmonic oscillator basis<a class="headerlink" href="#adding-spin-to-the-harmonic-oscillator-basis" title="Permalink to this headline">¶</a></h2>
<p>From <span class="xref myst">task-1</span> we have constructed a spatial basis of harmonic oscillator eigenstates <span class="math notranslate nohighlight">\(\{\chi_{\alpha}\}_{\alpha = 1}^{l}\)</span>, with spin-independent matrix elements <span class="math notranslate nohighlight">\(h_{\alpha \beta}\)</span>, <span class="math notranslate nohighlight">\(u^{\alpha \beta}_{\gamma \delta}\)</span>, etc.
We now wish to include spin in the harmonic oscillator basis functions.
The way we do this is by doubling each spatial basis function (and hence each axis in the matrix elements) essentially creating duplicates.</p>
<p>We will denote this basis of general harmonic oscillator spin-orbitals by <span class="math notranslate nohighlight">\(\{\psi_{\mu}\}_{\mu = 1}^{2l}\)</span>.
The question is then how we can go from <span class="math notranslate nohighlight">\(h_{\alpha \beta} \to h_{\mu \nu}\)</span> and similarly for the other matrix elements.
We let the general harmonic oscillator spin-orbitals be given by</p>
<div class="amsmath math notranslate nohighlight" id="equation-f4c03079-d7f5-4d00-aa02-d86aa798a785">
<span class="eqno">(10)<a class="headerlink" href="#equation-f4c03079-d7f5-4d00-aa02-d86aa798a785" title="Permalink to this equation">¶</a></span>\[\begin{align}
    |\psi_{\mu}\rangle
    &amp;= |\chi_{\alpha}\rangle \otimes |\sigma\rangle,
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(\alpha = \mu // 2\)</span> (integer division), and <span class="math notranslate nohighlight">\(\sigma = \alpha\)</span> if <span class="math notranslate nohighlight">\(\mu\)</span> is even and <span class="math notranslate nohighlight">\(\sigma = \beta\)</span> if <span class="math notranslate nohighlight">\(\mu\)</span> is odd.
The one-body Hamiltonian matrix elements are thus given by</p>
<div class="amsmath math notranslate nohighlight" id="equation-8367a764-9412-4f79-99d7-f1b3b7b6e2b7">
<span class="eqno">(11)<a class="headerlink" href="#equation-8367a764-9412-4f79-99d7-f1b3b7b6e2b7" title="Permalink to this equation">¶</a></span>\[\begin{align}
    h_{\mu \nu}
    &amp;= \langle \psi_{\mu} | \hat{h} \otimes I_{2 \times 2} | \psi_{\nu} \rangle
    = \left(\langle \chi_{\alpha} | \otimes \langle \sigma | \right)
    \hat{h} \otimes I_{2 \times 2} \left( | \chi_{\beta} \rangle \otimes | \tau \rangle \right)
    \\
    &amp;= \langle \chi_{\alpha} | \hat{h} | \chi_{\beta} \rangle
    \langle \sigma | \tau \rangle
    = h_{\alpha \beta} \delta_{\sigma \tau},
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(I_{2 \times 2}\)</span> is a <span class="math notranslate nohighlight">\(2 \times 2\)</span> idenity matrix, and we’ve chosen an orthonormal basis of spin states.
The full matrix <span class="math notranslate nohighlight">\(\mathbf{h}\)</span> in the</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="task-1-single-particle-basis.html" title="previous page">Task 1: Single-particle basis</a>
    <a class='right-next' id="next-link" href="markdown.html" title="next page">Markdown Files</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Øyvind Sigmundson Schøyen<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="_static/js/index.d3f166471bb80abb5163.js"></script>


    
  </body>
</html>