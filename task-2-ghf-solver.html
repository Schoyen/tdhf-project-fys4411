
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Task 2: General Hartree-Fock solver &#8212; FYS4411 - Project 2 TDHF</title>
    
  <link rel="stylesheet" href="_static/css/index.f658d18f9b420779cfdf24aa0a7e2d77.css">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/sphinx-book-theme.e7340bb3dbd8dde6db86f25597f54a1b.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.d3f166471bb80abb5163.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.7d483ff0a819d6edff12ce0b1ead3928.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Task 3: Expectation values" href="task-3-expectation-values.html" />
    <link rel="prev" title="Task 1: Single-particle basis" href="task-1-single-particle-basis.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  <img src="_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">FYS4411 - Project 2 TDHF</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   Time-dependent Hartree-Fock theory
  </a>
 </li>
</ul>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="task-1-single-particle-basis.html">
   Task 1: Single-particle basis
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Task 2: General Hartree-Fock solver
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="task-3-expectation-values.html">
   Task 3: Expectation values
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="task-4-tdghf-solver.html">
   Task 4: Time-dependent general Hartree-Fock solver
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="task-5-td-expectation-values.html">
   Task 5: Time-dependent expectation values
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="markdown.html">
   Markdown Files
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks.html">
   Content with notebooks
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/task-2-ghf-solver.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/Schoyen/tdhf-project-fys4411"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/Schoyen/tdhf-project-fys4411/issues/new?title=Issue%20on%20page%20%2Ftask-2-ghf-solver.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>


            <!-- Full screen (wrap in <a> to have style consistency -->
            <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                    data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                    title="Fullscreen mode"><i
                        class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/Schoyen/tdhf-project-fys4411/master?urlpath=tree/docs/task-2-ghf-solver.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i>
            Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#types-of-orbital-systems">
   Types of orbital systems
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#adding-spin-to-the-harmonic-oscillator-basis">
   Adding spin to the harmonic oscillator basis
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-roothan-hall-equations">
   The Roothan-Hall equations
  </a>
 </li>
</ul>

        </nav>
        
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="task-2-general-hartree-fock-solver">
<h1>Task 2: General Hartree-Fock solver<a class="headerlink" href="#task-2-general-hartree-fock-solver" title="Permalink to this headline">¶</a></h1>
<p>Having set up an initial single-particle basis set <span class="math notranslate nohighlight">\(\{\chi_{\alpha}\}_{\alpha = 1}^{l}\)</span> we now set out to find the ground state of the two-body fermion problem.
The full time-independent Hamiltonian used by <span id="id1">[<a class="reference internal" href="intro.html#id3"><span>ZKBS04</span></a>]</span> is given by</p>
<div class="amsmath math notranslate nohighlight" id="equation-c10df99f-96a1-436b-a777-94b1dcb38a64">
<span class="eqno">(5)<a class="headerlink" href="#equation-c10df99f-96a1-436b-a777-94b1dcb38a64" title="Permalink to this equation">¶</a></span>\[\begin{align}
    \hat{H}
    = \hat{h} + \hat{u}
    = \sum_{i = 1}^{n}\left(
        -\frac{1}{2}\frac{\text{d}^2}{\text{d}x^2}
        + \frac{1}{2}\omega^2 x^2
    \right)
    + \sum_{i = 1}^{n} \sum_{j = i + 1}^{n} \frac{\alpha}{\sqrt{(x_i - x_j)^2 + a^2}},
\end{align}\]</div>
<p>where the number of particles <span class="math notranslate nohighlight">\(n = 2\)</span>, <span class="math notranslate nohighlight">\(a = 0.25\)</span>, <span class="math notranslate nohighlight">\(\alpha = 1\)</span> (not to be confused with the index <span class="math notranslate nohighlight">\(\alpha\)</span> in the basis of harmonic oscillator eigenstates), and <span class="math notranslate nohighlight">\(\omega = 0.25\)</span>.</p>
<p>We start from the time-independent Schrödinger equation</p>
<div class="amsmath math notranslate nohighlight" id="equation-24c67be5-80f3-46e6-8137-4039ef343c15">
<span class="eqno">(6)<a class="headerlink" href="#equation-24c67be5-80f3-46e6-8137-4039ef343c15" title="Permalink to this equation">¶</a></span>\[\begin{align}
    \hat{H} | \Psi \rangle = E | \Psi \rangle,
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(| \Psi \rangle\)</span> is a many-body wave function.
We know that in the non-interacting case the exact ground state of the Hamiltonian will be a single Slater determinant (which we denote <span class="math notranslate nohighlight">\(| \Phi \rangle\)</span>) of the lowest single-particle eigenstates.
This motivates the ansatz of using a single Slater determinant for the full many-body problem</p>
<div class="amsmath math notranslate nohighlight" id="equation-b53de8ff-12bc-4ac2-9b77-9cdb7e94f42b">
<span class="eqno">(7)<a class="headerlink" href="#equation-b53de8ff-12bc-4ac2-9b77-9cdb7e94f42b" title="Permalink to this equation">¶</a></span>\[\begin{align}
    | \Psi \rangle \approx | \Phi \rangle.
\end{align}\]</div>
<p>Now, the goal of the Hartree-Fock method is to find the single Slater determinant that minimizes the energy, i.e., gets closest to the “true” many-body ground state energy <span class="math notranslate nohighlight">\(E_{gs}\)</span> of the problem.
This is formulated via the variational principle</p>
<div class="amsmath math notranslate nohighlight" id="equation-1bbb45fc-526e-402c-95e7-473fe7e6355c">
<span class="eqno">(8)<a class="headerlink" href="#equation-1bbb45fc-526e-402c-95e7-473fe7e6355c" title="Permalink to this equation">¶</a></span>\[\begin{align}
    E_{gs} \leq E[\Psi] = \langle \Psi | \hat{H} | \Psi \rangle,
\end{align}\]</div>
<p>for any normalized wave function <span class="math notranslate nohighlight">\(| \Psi \rangle\)</span>.
There is also an extra requirement on the Hartree-Fock wave function, and that is that the Hartree-Fock orbitals (which we denote <span class="math notranslate nohighlight">\(\{\phi_i\}_{i = 1}^{k}\)</span>) should be orthonormal, i.e., <span class="math notranslate nohighlight">\(\langle \phi_i | \phi_j \rangle = \delta_{ij}\)</span>.
To include this requirement in the variational principle we use Lagrange’s method of undetermined multipliers</p>
<div class="math notranslate nohighlight" id="equation-eq-hf-lagrangian">
<span class="eqno">(9)<a class="headerlink" href="#equation-eq-hf-lagrangian" title="Permalink to this equation">¶</a></span>\[
    L[\Psi, \boldsymbol{\lambda}]
    = E[\Psi]
    - \lambda_{ji} \left(
        \langle \phi_i | \phi_j \rangle
        - \delta_{ij}
    \right),
\]</div>
<p>where <span class="math notranslate nohighlight">\(\boldsymbol{\lambda}\)</span> are the Lagrange multipliers.
To avoid confusion with any other Slater determinants we will introduce the notation <span class="math notranslate nohighlight">\(| \text{HF} \rangle = |\phi_1\dots\phi_n\rangle\)</span> for the optimized Hartree-Fock Slater determinant.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Add derivation of the (canonical) GHF-equations.</p>
</div>
<p>Minimization of the Lagrangian in <a class="reference internal" href="#equation-eq-hf-lagrangian">(9)</a> yields the Hartree-Fock eigenvalue equation</p>
<div class="math notranslate nohighlight" id="equation-eq-canonical-hf-equation">
<span class="eqno">(10)<a class="headerlink" href="#equation-eq-canonical-hf-equation" title="Permalink to this equation">¶</a></span>\[
    \hat{f} | \phi_p \rangle = \varepsilon_p | \phi_p \rangle,
\]</div>
<p>where <span class="math notranslate nohighlight">\(\hat{f}\)</span> is the single-particle Fock-operator.
Note that this equation is not limited to the occupied states (denoted <span class="math notranslate nohighlight">\(\{ \phi_i \}_{i = 1}^n\)</span>) in <span class="math notranslate nohighlight">\(|\text{HF}\rangle\)</span>, but to all states (denoted <span class="math notranslate nohighlight">\(\{ \phi_p \}_{p = 1}^k\)</span>).
The matrix elements of the single-particle Fock operator are given by</p>
<div class="amsmath math notranslate nohighlight" id="equation-848e347d-9c90-4294-8c12-a4c1e594e4db">
<span class="eqno">(11)<a class="headerlink" href="#equation-848e347d-9c90-4294-8c12-a4c1e594e4db" title="Permalink to this equation">¶</a></span>\[\begin{align}
    \langle \psi | \hat{f} | \xi \rangle
    = \langle \psi | \hat{h} | \xi \rangle
    + \sum_{i = 1}^{n} \langle \psi \phi_i | \hat{u} | \xi \phi_i \rangle
    - \sum_{i = 1}^{n} \langle \psi \phi_i | \hat{u} | \phi_i \xi \rangle,
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(|\psi\rangle\)</span> and <span class="math notranslate nohighlight">\(|\xi \rangle\)</span> are two arbitrary single-particle states.</p>
<div class="section" id="types-of-orbital-systems">
<h2>Types of orbital systems<a class="headerlink" href="#types-of-orbital-systems" title="Permalink to this headline">¶</a></h2>
<p>In quantum chemistry it is common to call the initial single-particle functions for <em>atomic orbitals</em> (AO).
We will also adhere to this convention, thus making the basis of harmonic oscillator single-particle functions the atomic orbitals of our system.
Now, as the harmonic oscillator Hamiltonian is independent of spin we have restricted our view to the spatial part of the atomic orbitals when using quantum-systems to construct our basis elements.
However, when moving to the full fermionic many-body picture (two = many) we have to include spin to get the full picture.
We often talk about three kinds of orbitals depending on the restrictions put on spin.</p>
<ol>
<li><p>The general spin-orbital is on the form</p>
<div class="amsmath math notranslate nohighlight" id="equation-6c50d9a7-aae9-4b3e-bdf1-9c5fbb72961c">
<span class="eqno">(12)<a class="headerlink" href="#equation-6c50d9a7-aae9-4b3e-bdf1-9c5fbb72961c" title="Permalink to this equation">¶</a></span>\[\begin{align}
        \phi(x, m_s)
        &amp;= \varphi_1(x) \alpha(m_s) + \varphi_2(x) \beta(m_s),
    \end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(\varphi_i(x)\)</span> are the spatial oribtals, and <span class="math notranslate nohighlight">\(\sigma \in \{\alpha, \beta\}\)</span> are spin basis functions with <span class="math notranslate nohighlight">\(m_s \in \{\uparrow, \downarrow\}\)</span> the spin quantum number.
Typical choices for the spin basis functions are</p>
<div class="amsmath math notranslate nohighlight" id="equation-9c61dcd5-8d2a-4fcd-a207-3dbdf8bf6762">
<span class="eqno">(13)<a class="headerlink" href="#equation-9c61dcd5-8d2a-4fcd-a207-3dbdf8bf6762" title="Permalink to this equation">¶</a></span>\[\begin{gather}
        \alpha(\uparrow) = 1, \quad \beta(\uparrow) = 0, \\
        \alpha(\downarrow) = 0, \quad \beta(\downarrow) = 1.
    \end{gather}\]</div>
</li>
<li><p>The unrestricted spin-orbital is on the form</p>
<div class="amsmath math notranslate nohighlight" id="equation-045b69f5-374e-40f0-9a14-fc84b7a9f787">
<span class="eqno">(14)<a class="headerlink" href="#equation-045b69f5-374e-40f0-9a14-fc84b7a9f787" title="Permalink to this equation">¶</a></span>\[\begin{align}
        \phi(x, m_s)
        = \varphi_{\sigma}(x) \sigma(m_s),
    \end{align}\]</div>
<p>where an unrestricted spin-orbital has a definite spin-direction (either <span class="math notranslate nohighlight">\(\alpha\)</span> or <span class="math notranslate nohighlight">\(\beta\)</span>), but allows for the spatial part to be different between spin-directions.</p>
</li>
<li><p>The restricted spin-orbital is on the form</p>
<div class="amsmath math notranslate nohighlight" id="equation-bf043d4c-4a69-4b18-9d3b-a3ad6ba27fd0">
<span class="eqno">(15)<a class="headerlink" href="#equation-bf043d4c-4a69-4b18-9d3b-a3ad6ba27fd0" title="Permalink to this equation">¶</a></span>\[\begin{align}
        \phi(x, m_s)
        = \varphi(x) \sigma(m_s),
    \end{align}\]</div>
<p>where the spin-orbitals have a definite spin-direction with the spatial part equal between the two spin-directions.</p>
</li>
</ol>
<p>We will in this project create a general Hartree-Fock (GHF) solver which implies that we use general spin-orbitals.
This will turn out to be easiest mathematically (when deriving the equations for GHF) and the most general formulation.
However, the restricted and unrestricted formulations are more numerically efficient.</p>
</div>
<div class="section" id="adding-spin-to-the-harmonic-oscillator-basis">
<h2>Adding spin to the harmonic oscillator basis<a class="headerlink" href="#adding-spin-to-the-harmonic-oscillator-basis" title="Permalink to this headline">¶</a></h2>
<p>From <a class="reference internal" href="task-1-single-particle-basis.html#task-1-mel"><span class="std std-ref">task-1</span></a> we have constructed a spatial basis of harmonic oscillator eigenstates <span class="math notranslate nohighlight">\(\{\chi_{\alpha}\}_{\alpha = 1}^{l}\)</span>, with spin-independent matrix elements <span class="math notranslate nohighlight">\(h_{\alpha \beta}\)</span>, <span class="math notranslate nohighlight">\(u^{\alpha \beta}_{\gamma \delta}\)</span>, etc.
We now wish to include spin in the harmonic oscillator basis functions.
The way we do this is by doubling each spatial basis function (and hence each axis in the matrix elements) essentially creating duplicates.</p>
<p>We will denote this basis of general harmonic oscillator spin-orbitals by <span class="math notranslate nohighlight">\(\{\psi_{\mu}\}_{\mu = 1}^{2l}\)</span>.
The question is then how we can go from <span class="math notranslate nohighlight">\(h_{\alpha \beta} \to h_{\mu \nu}\)</span> and similarly for the other matrix elements.
We let the general harmonic oscillator spin-orbitals be given by</p>
<div class="amsmath math notranslate nohighlight" id="equation-60cc0458-6dd1-467d-893b-6b28e7b2a649">
<span class="eqno">(16)<a class="headerlink" href="#equation-60cc0458-6dd1-467d-893b-6b28e7b2a649" title="Permalink to this equation">¶</a></span>\[\begin{align}
    |\psi_{\mu}\rangle
    &amp;= |\chi_{\alpha}\rangle \otimes |\sigma\rangle,
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(\alpha = \mu // 2\)</span> (integer division), and <span class="math notranslate nohighlight">\(\sigma = \alpha\)</span> if <span class="math notranslate nohighlight">\(\mu\)</span> is even and <span class="math notranslate nohighlight">\(\sigma = \beta\)</span> if <span class="math notranslate nohighlight">\(\mu\)</span> is odd.
The one-body Hamiltonian matrix elements are thus given by</p>
<div class="amsmath math notranslate nohighlight" id="equation-6e4bb41c-2f6f-48db-9b45-9e263a0c3a57">
<span class="eqno">(17)<a class="headerlink" href="#equation-6e4bb41c-2f6f-48db-9b45-9e263a0c3a57" title="Permalink to this equation">¶</a></span>\[\begin{align}
    h_{\mu \nu}
    &amp;= \langle \psi_{\mu} | \hat{h} \otimes \hat{I} | \psi_{\nu} \rangle
    = \left(\langle \chi_{\alpha} | \otimes \langle \sigma | \right)
    \hat{h} \otimes \hat{I} \left( | \chi_{\beta} \rangle \otimes | \tau \rangle \right)
    \\
    &amp;= \langle \chi_{\alpha} | \hat{h} | \chi_{\beta} \rangle
    \langle \sigma | \tau \rangle
    = h_{\alpha \beta} \delta_{\sigma \tau},
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(\hat{I}\)</span> is the spin-basis identity operator, and we’ve chosen an orthonormal basis of spin states.
The full general spin-orbital matrix <span class="math notranslate nohighlight">\(\mathbf{h}_{GSO}\)</span> can then be constructed from the (spatial) atomic orbital matrix <span class="math notranslate nohighlight">\(\mathbf{h}_{SpaS}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{I}_{2\times 2}\)</span> the <span class="math notranslate nohighlight">\(2 \times 2\)</span> identity matrix by</p>
<div class="amsmath math notranslate nohighlight" id="equation-9f49d310-683e-4a68-8db1-cfea8da3fa0d">
<span class="eqno">(18)<a class="headerlink" href="#equation-9f49d310-683e-4a68-8db1-cfea8da3fa0d" title="Permalink to this equation">¶</a></span>\[\begin{align}
    \mathbf{h}_{GSO} = \mathbf{h}_{SpaS} \otimes \mathbf{I}_{2 \times 2},
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(\otimes\)</span> is the Kronecker product.
This ensures that all even (odd) indices correspond to <span class="math notranslate nohighlight">\(\alpha\)</span> (<span class="math notranslate nohighlight">\(\beta\)</span>) spin-states.
From <a class="reference external" href="https://github.com/Schoyen/quantum-systems">quantum-systems</a> this is done automatically when passing in a <code class="docutils literal notranslate"><span class="pre">BasisSet</span></code> to the class <code class="docutils literal notranslate"><span class="pre">GeneralOrbitalSystem</span></code>.
Below we demonstrate how this is done for harmonic oscillator basis set.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">reload_ext</span> nb_black
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 1;
                var nbb_unformatted_code = "%reload_ext nb_black";
                var nbb_formatted_code = "%reload_ext nb_black";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">from</span> <span class="nn">quantum_systems</span> <span class="kn">import</span> <span class="n">ODQD</span><span class="p">,</span> <span class="n">GeneralOrbitalSystem</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 2;
                var nbb_unformatted_code = "import numpy as np\nimport matplotlib.pyplot as plt\n\nfrom quantum_systems import ODQD, GeneralOrbitalSystem";
                var nbb_formatted_code = "import numpy as np\nimport matplotlib.pyplot as plt\n\nfrom quantum_systems import ODQD, GeneralOrbitalSystem";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">2</span>  <span class="c1"># Number of particles</span>
<span class="n">l</span> <span class="o">=</span> <span class="mi">10</span>  <span class="c1"># Number of eigenstates</span>
<span class="n">grid_length</span> <span class="o">=</span> <span class="mi">10</span>  <span class="c1"># The width of the one-dimensional grid</span>
<span class="n">num_grid_points</span> <span class="o">=</span> <span class="mi">2001</span>  <span class="c1"># The number of discretized points on the grid.</span>
<span class="c1"># More points give better results for the single-particle basis at the cost of slower setup.</span>

<span class="n">alpha</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># The strength of the Coulomb interaction</span>
<span class="n">a</span> <span class="o">=</span> <span class="mf">0.25</span>  <span class="c1"># The shielding parameter in the Coulomb interaction potential</span>

<span class="n">omega</span> <span class="o">=</span> <span class="mf">0.25</span>  <span class="c1"># The frequency of the harmonic oscillator trap</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 3;
                var nbb_unformatted_code = "n = 2  # Number of particles\nl = 10  # Number of eigenstates\ngrid_length = 10  # The width of the one-dimensional grid\nnum_grid_points = 2001  # The number of discretized points on the grid.\n# More points give better results for the single-particle basis at the cost of slower setup.\n\nalpha = 1  # The strength of the Coulomb interaction\na = 0.25  # The shielding parameter in the Coulomb interaction potential\n\nomega = 0.25  # The frequency of the harmonic oscillator trap";
                var nbb_formatted_code = "n = 2  # Number of particles\nl = 10  # Number of eigenstates\ngrid_length = 10  # The width of the one-dimensional grid\nnum_grid_points = 2001  # The number of discretized points on the grid.\n# More points give better results for the single-particle basis at the cost of slower setup.\n\nalpha = 1  # The strength of the Coulomb interaction\na = 0.25  # The shielding parameter in the Coulomb interaction potential\n\nomega = 0.25  # The frequency of the harmonic oscillator trap";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">potential</span> <span class="o">=</span> <span class="n">ODQD</span><span class="o">.</span><span class="n">HOPotential</span><span class="p">(</span><span class="n">omega</span><span class="o">=</span><span class="n">omega</span><span class="p">)</span>  <span class="c1"># Harmonic oscillator potential</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 4;
                var nbb_unformatted_code = "potential = ODQD.HOPotential(omega=omega)  # Harmonic oscillator potential";
                var nbb_formatted_code = "potential = ODQD.HOPotential(omega=omega)  # Harmonic oscillator potential";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">odqd</span> <span class="o">=</span> <span class="n">ODQD</span><span class="p">(</span>
    <span class="n">l</span><span class="o">=</span><span class="n">l</span><span class="p">,</span>
    <span class="n">grid_length</span><span class="o">=</span><span class="n">grid_length</span><span class="p">,</span>
    <span class="n">num_grid_points</span><span class="o">=</span><span class="n">num_grid_points</span><span class="p">,</span>
    <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
    <span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span>
    <span class="n">potential</span><span class="o">=</span><span class="n">potential</span><span class="p">,</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Basis l: </span><span class="si">{</span><span class="n">odqd</span><span class="o">.</span><span class="n">l</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Basis grid: </span><span class="si">{</span><span class="n">odqd</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Basis h.shape: </span><span class="si">{</span><span class="n">odqd</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Basis u.shape: </span><span class="si">{</span><span class="n">odqd</span><span class="o">.</span><span class="n">u</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Basis x.shape: </span><span class="si">{</span><span class="n">odqd</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Basis spf.shape: </span><span class="si">{</span><span class="n">odqd</span><span class="o">.</span><span class="n">spf</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Basis l: 10
Basis grid: (2001,)
Basis h.shape: (10, 10)
Basis u.shape: (10, 10, 10, 10)
Basis x.shape: (1, 10, 10)
Basis spf.shape: (10, 2001)
</pre></div>
</div>
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 5;
                var nbb_unformatted_code = "odqd = ODQD(\n    l=l,\n    grid_length=grid_length,\n    num_grid_points=num_grid_points,\n    alpha=alpha,\n    a=a,\n    potential=potential,\n)\n\nprint(f\"Basis l: {odqd.l}\")\nprint(f\"Basis grid: {odqd.grid.shape}\")\nprint(f\"Basis h.shape: {odqd.h.shape}\")\nprint(f\"Basis u.shape: {odqd.u.shape}\")\nprint(f\"Basis x.shape: {odqd.position.shape}\")\nprint(f\"Basis spf.shape: {odqd.spf.shape}\")";
                var nbb_formatted_code = "odqd = ODQD(\n    l=l,\n    grid_length=grid_length,\n    num_grid_points=num_grid_points,\n    alpha=alpha,\n    a=a,\n    potential=potential,\n)\n\nprint(f\"Basis l: {odqd.l}\")\nprint(f\"Basis grid: {odqd.grid.shape}\")\nprint(f\"Basis h.shape: {odqd.h.shape}\")\nprint(f\"Basis u.shape: {odqd.u.shape}\")\nprint(f\"Basis x.shape: {odqd.position.shape}\")\nprint(f\"Basis spf.shape: {odqd.spf.shape}\")";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># This adds spin to all matrix elements</span>
<span class="c1"># Note that gos.l = 2 * l</span>
<span class="c1"># Note also that odqd itself is transformed into a general orbital system.</span>
<span class="c1"># If you want to keep the pure spatial basis you can pass in a copy, viz.</span>
<span class="c1"># gos = GeneralOrbitalSystem(n, gos.copy_basis())</span>
<span class="n">gos</span> <span class="o">=</span> <span class="n">GeneralOrbitalSystem</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">odqd</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;GOS l: </span><span class="si">{</span><span class="n">gos</span><span class="o">.</span><span class="n">l</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;GOS grid: </span><span class="si">{</span><span class="n">gos</span><span class="o">.</span><span class="n">_basis_set</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;GOS h.shape: </span><span class="si">{</span><span class="n">gos</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;GOS u.shape: </span><span class="si">{</span><span class="n">gos</span><span class="o">.</span><span class="n">u</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;GOS x.shape: </span><span class="si">{</span><span class="n">gos</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;GOS spf.shape: </span><span class="si">{</span><span class="n">gos</span><span class="o">.</span><span class="n">spf</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>GOS l: 20
GOS grid: (2001,)
GOS h.shape: (20, 20)
GOS u.shape: (20, 20, 20, 20)
GOS x.shape: (1, 20, 20)
GOS spf.shape: (20, 2001)
</pre></div>
</div>
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 6;
                var nbb_unformatted_code = "# This adds spin to all matrix elements\n# Note that gos.l = 2 * l\n# Note also that odqd itself is transformed into a general orbital system.\n# If you want to keep the pure spatial basis you can pass in a copy, viz.\n# gos = GeneralOrbitalSystem(n, gos.copy_basis())\ngos = GeneralOrbitalSystem(n, odqd)\n\nprint(f\"GOS l: {gos.l}\")\nprint(f\"GOS grid: {gos._basis_set.grid.shape}\")\nprint(f\"GOS h.shape: {gos.h.shape}\")\nprint(f\"GOS u.shape: {gos.u.shape}\")\nprint(f\"GOS x.shape: {gos.position.shape}\")\nprint(f\"GOS spf.shape: {gos.spf.shape}\")";
                var nbb_formatted_code = "# This adds spin to all matrix elements\n# Note that gos.l = 2 * l\n# Note also that odqd itself is transformed into a general orbital system.\n# If you want to keep the pure spatial basis you can pass in a copy, viz.\n# gos = GeneralOrbitalSystem(n, gos.copy_basis())\ngos = GeneralOrbitalSystem(n, odqd)\n\nprint(f\"GOS l: {gos.l}\")\nprint(f\"GOS grid: {gos._basis_set.grid.shape}\")\nprint(f\"GOS h.shape: {gos.h.shape}\")\nprint(f\"GOS u.shape: {gos.u.shape}\")\nprint(f\"GOS x.shape: {gos.position.shape}\")\nprint(f\"GOS spf.shape: {gos.spf.shape}\")";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<p>Looking at the output above we see that the number of basis elements <span class="math notranslate nohighlight">\(l\)</span> have been doubled.
However, the grid and the number of dimensions (the first axis in <code class="docutils literal notranslate"><span class="pre">gos.position</span></code>) are unchanged.
It is worth pointing out that <code class="docutils literal notranslate"><span class="pre">gos.spf[::2]</span></code> (all even indices) correspond to the spatial part of the <span class="math notranslate nohighlight">\(\alpha\)</span> component of a general spin-orbital and <code class="docutils literal notranslate"><span class="pre">gos.spf[1::2]</span></code> (all odd indices) the <span class="math notranslate nohighlight">\(\beta\)</span> component.</p>
</div>
<div class="section" id="the-roothan-hall-equations">
<h2>The Roothan-Hall equations<a class="headerlink" href="#the-roothan-hall-equations" title="Permalink to this headline">¶</a></h2>
<p>The way we solve the Hartree-Fock equation in <a class="reference internal" href="#equation-eq-canonical-hf-equation">(10)</a> is by expanding the Hartree-Fock orbitals (also called molecular orbitals (MO)) <span class="math notranslate nohighlight">\(\{ \phi_p \}_{p = 1}^k\)</span> in an atomic orbital basis <span class="math notranslate nohighlight">\(\{ \psi_{\mu} \}_{\mu = 1}^{l}\)</span> (which we here take to be the harmonic oscillator basis states with spin-doubling), and then projecting the equations onto the known basis set.
We express a basis transformation from the AO basis to the MO basis by</p>
<div class="math notranslate nohighlight" id="equation-eq-basis-transformation">
<span class="eqno">(19)<a class="headerlink" href="#equation-eq-basis-transformation" title="Permalink to this equation">¶</a></span>\[
    |\phi_p\rangle = \sum_{\mu = 1}^{l} C_{\mu p} | \psi_{\mu} \rangle,
\]</div>
<p>where the coefficients <span class="math notranslate nohighlight">\(C_{\mu p}\)</span> now become our primary unknowns in the Hartree-Fock method.
Projecting the AO basis onto equation <a class="reference internal" href="#equation-eq-canonical-hf-equation">(10)</a> we have</p>
<div class="amsmath math notranslate nohighlight" id="equation-2b01feff-6b2c-4f1e-9338-2e989535976d">
<span class="eqno">(20)<a class="headerlink" href="#equation-2b01feff-6b2c-4f1e-9338-2e989535976d" title="Permalink to this equation">¶</a></span>\[\begin{gather}
    \langle \psi_{\mu} | \hat{f} | \phi_p \rangle
    = \varepsilon_{p} \langle \psi_{\mu} | \phi_p \rangle
    \implies
    \sum_{\nu = 1}^{l} f_{\mu \nu} C_{\nu p}
    = \varepsilon_{p} \sum_{\nu = 1}^{l} \delta_{\mu \nu} C_{\nu p}
    =  C_{\mu p} \varepsilon_{p}
    \\
    \implies
    \mathbf{F} \mathbf{C}
    = \mathbf{C} \boldsymbol{\varepsilon},
\end{gather}\]</div>
<p>where <span class="math notranslate nohighlight">\([\mathbf{F}]_{\mu \nu} = f_{\mu \nu} = \langle \psi_{\mu} | \hat{f} | \psi_{\nu} \rangle\)</span> are the Fock matrix elements in the AO basis, <span class="math notranslate nohighlight">\([\mathbf{C}]_{\mu p} = C_{\mu p}\)</span> the basis transformation coefficient matrix, and <span class="math notranslate nohighlight">\(\boldsymbol{\varepsilon} = [\varepsilon_1, \dots, \varepsilon_k]^T\)</span> the vector of Hartree-Fock single-particle eigenenergy (not to be confused with the full many-body energy).
The last eigenvalue equation is known as the Roothan-Hall equations.
Here both <span class="math notranslate nohighlight">\(\mathbf{C}\)</span> and <span class="math notranslate nohighlight">\(\boldsymbol{\varepsilon}\)</span> are the primary unknowns.</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="task-1-single-particle-basis.html" title="previous page">Task 1: Single-particle basis</a>
    <a class='right-next' id="next-link" href="task-3-expectation-values.html" title="next page">Task 3: Expectation values</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Øyvind Sigmundson Schøyen<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="_static/js/index.d3f166471bb80abb5163.js"></script>


    
  </body>
</html>