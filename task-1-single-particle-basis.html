
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Task 1: Single-particle basis &#8212; FYS4411 - Project 2 TDHF</title>
    
  <link href="_static/css/theme.css" rel="stylesheet" />
  <link href="_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/sphinx-book-theme.acff12b8f9c144ce68a297486a2fa670.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Task 2: General Hartree-Fock solver" href="task-2-ghf-solver.html" />
    <link rel="prev" title="Time-dependent Hartree-Fock theory" href="intro.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
      <img src="_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">FYS4411 - Project 2 TDHF</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   Time-dependent Hartree-Fock theory
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Task 1: Single-particle basis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="task-2-ghf-solver.html">
   Task 2: General Hartree-Fock solver
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="task-3-expectation-values.html">
   Task 3: Expectation values
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="task-4-tdghf-solver.html">
   Task 4: Time-dependent general Hartree-Fock solver
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="task-5-td-expectation-values.html">
   Task 5: Time-dependent expectation values
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="markdown.html">
   Markdown Files
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks.html">
   Content with notebooks
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/task-1-single-particle-basis.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/Schoyen/tdhf-project-fys4411"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/Schoyen/tdhf-project-fys4411/issues/new?title=Issue%20on%20page%20%2Ftask-1-single-particle-basis.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/Schoyen/tdhf-project-fys4411/master?urlpath=tree/docs/task-1-single-particle-basis.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#one-body-harmonic-oscillator-hamiltonian">
   One-body harmonic oscillator Hamiltonian
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#setting-up-the-basis-using-finite-differences">
   Setting up the basis using finite-differences
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#matrix-elements">
     Matrix elements
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#plotting-the-basis-elements">
     Plotting the basis elements
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#types-of-orbital-systems">
   Types of orbital systems
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#adding-spin-to-the-harmonic-oscillator-basis">
   Adding spin to the harmonic oscillator basis
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#anti-symmetric-two-body-elements">
     Anti-symmetric two-body elements
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="task-1-single-particle-basis">
<h1>Task 1: Single-particle basis<a class="headerlink" href="#task-1-single-particle-basis" title="Permalink to this headline">¶</a></h1>
<p>We will here discuss how to set up the single-particle basis for the Hamiltonian used by <span id="id1">[<a class="reference internal" href="intro.html#id3"><span>ZKBS04</span></a>]</span>. To achieve this we will solve the one-body Hamiltonian on a grid using finite differences. This will give us an approximation to the eigenstates and eigenenergies of the non-interacting single-particle problem.</p>
<div class="section" id="one-body-harmonic-oscillator-hamiltonian">
<h2>One-body harmonic oscillator Hamiltonian<a class="headerlink" href="#one-body-harmonic-oscillator-hamiltonian" title="Permalink to this headline">¶</a></h2>
<p>In <span id="id2">[<a class="reference internal" href="intro.html#id3"><span>ZKBS04</span></a>]</span> they look at two particles in a one-dimensional Hamiltonian coupled with a soft Coulomb interaction.
We will use a single-particle basis of one-dimensional harmonic oscillator eigenfunctions.
To construct this basis we diagonalize a one-dimensional harmonic oscillator Hamiltonian without the interaction term.
The Hamiltonian is then given by</p>
<div class="amsmath math notranslate nohighlight" id="equation-e7fe22a1-3835-4658-8109-8fa77bfcbabf">
<span class="eqno">(1)<a class="headerlink" href="#equation-e7fe22a1-3835-4658-8109-8fa77bfcbabf" title="Permalink to this equation">¶</a></span>\[\begin{align}
    \hat{h}
    = -\frac{1}{2} \frac{\text{d}^2}{\text{d}x^2}
    + \frac{1}{2} \omega^2 \hat{x}^2,
\end{align}\]</div>
<p>where we use natural units with <span class="math notranslate nohighlight">\(\hbar = m = 1\)</span>.
We proceed by solving the time-independent Schrödinger equation, viz.</p>
<div class="amsmath math notranslate nohighlight" id="equation-e0aed54e-8f8f-4e99-978d-b7ade3462e75">
<span class="eqno">(2)<a class="headerlink" href="#equation-e0aed54e-8f8f-4e99-978d-b7ade3462e75" title="Permalink to this equation">¶</a></span>\[\begin{align}
    \hat{h}|\chi_{\alpha}\rangle
    = \epsilon_{\alpha}|\chi_{\alpha}\rangle,
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(\epsilon_{\alpha}\)</span> are the eigenenergies and <span class="math notranslate nohighlight">\(|\chi_{\alpha}\rangle\)</span> the corresponding eigenstates.
We already know the answers to this equation from <span id="id3">[<a class="reference internal" href="intro.html#id4"><span>Gri10</span></a>]</span>.
The eigenenergies are <span class="math notranslate nohighlight">\(\epsilon_{\alpha} = \omega(\alpha + 1/2)\)</span> for the energies and</p>
<div class="amsmath math notranslate nohighlight" id="equation-e85beb10-94b5-4a85-ace2-d50f45ae9805">
<span class="eqno">(3)<a class="headerlink" href="#equation-e85beb10-94b5-4a85-ace2-d50f45ae9805" title="Permalink to this equation">¶</a></span>\[\begin{align}
    \chi_{\alpha}(x) = \left(\frac{\omega}{\pi}\right)^{1 / 4}
    \frac{1}{\sqrt{2^{\alpha} \alpha!}} H_{\alpha}(\sqrt{\omega} x),
\end{align}\]</div>
<p>for the eigenstates projected onto <span class="math notranslate nohighlight">\(x\)</span>.
The <span class="math notranslate nohighlight">\(H_{\alpha}(x)\)</span> are the physicists’ Hermite polynomials.</p>
</div>
<div class="section" id="setting-up-the-basis-using-finite-differences">
<h2>Setting up the basis using finite-differences<a class="headerlink" href="#setting-up-the-basis-using-finite-differences" title="Permalink to this headline">¶</a></h2>
<p>We will however be using the <a class="reference external" href="https://github.com/Schoyen/quantum-systems">quantum-systems library</a> to set up our basis functions.
This library uses finite-differences to solve the one-body Hamiltonian as this allows for arbitrary potentials of the form <span class="math notranslate nohighlight">\(\hat{v}(x)\)</span>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Add theory on how the diagonalization is done.</p>
</div>
<p>We choose a basis of the <span class="math notranslate nohighlight">\(l\)</span> first eigenstates.</p>
<div class="section" id="matrix-elements">
<span id="task-1-mel"></span><h3>Matrix elements<a class="headerlink" href="#matrix-elements" title="Permalink to this headline">¶</a></h3>
<p>The matrix elements we will be needing for this project are:</p>
<div class="amsmath math notranslate nohighlight" id="equation-f670992d-562d-418c-bcfc-e3994a492d1a">
<span class="eqno">(4)<a class="headerlink" href="#equation-f670992d-562d-418c-bcfc-e3994a492d1a" title="Permalink to this equation">¶</a></span>\[\begin{gather}
    h_{\alpha \beta} = \langle \chi_{\alpha} | \hat{h} | \chi_{\beta} \rangle
    = \epsilon_{\beta} \delta_{\alpha \beta}, \\
    u^{\alpha \beta}_{\gamma \delta}
    = \langle \chi_{\alpha} \chi_{\beta} | \hat{u} | \chi_{\gamma} \chi_{\delta} \rangle
    = \int \text{d}x_1 \text{d}x_2
    \frac{
        \chi^{*}_{\alpha}(x_1)
        \chi^{*}_{\beta}(x_2)
        \chi_{\gamma}(x_1)
        \chi_{\delta}(x_2)
    }{
        \sqrt{(x_1 - x_2)^2 + a^2}
    }, \\
    x_{\alpha \beta}
    = \langle \chi_{\alpha} | \hat{x} | \chi_{\beta} \rangle
    = \int \text{d} x
    \chi^{*}_{\alpha}(x)
    x
    \chi_{\beta}(x),
\end{gather}\]</div>
<p>where the position matrix elements <span class="math notranslate nohighlight">\(x_{\alpha \beta}\)</span> will be used for the laser field.
We will also need a representation of the single-particle functions on a grid, i.e., <span class="math notranslate nohighlight">\(\chi_{\alpha}(x)\)</span>.
Luckily, quantum-systems will construct all of these matrix elements and single-particle functions for us.
Below we demonstrate how these states can be found from the library.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">reload_ext</span> nb_black
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 1;
                var nbb_unformatted_code = "%reload_ext nb_black";
                var nbb_formatted_code = "%reload_ext nb_black";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">from</span> <span class="nn">quantum_systems</span> <span class="kn">import</span> <span class="n">ODQD</span><span class="p">,</span> <span class="n">GeneralOrbitalSystem</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 2;
                var nbb_unformatted_code = "import numpy as np\nimport matplotlib.pyplot as plt\n\nfrom quantum_systems import ODQD, GeneralOrbitalSystem";
                var nbb_formatted_code = "import numpy as np\nimport matplotlib.pyplot as plt\n\nfrom quantum_systems import ODQD, GeneralOrbitalSystem";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">l</span> <span class="o">=</span> <span class="mi">10</span>  <span class="c1"># Number of eigenstates</span>
<span class="n">grid_length</span> <span class="o">=</span> <span class="mi">10</span>  <span class="c1"># The width of the one-dimensional grid</span>
<span class="n">num_grid_points</span> <span class="o">=</span> <span class="mi">2001</span>  <span class="c1"># The number of discretized points on the grid.</span>
<span class="c1"># More points give better results for the single-particle basis at the cost of slower setup.</span>

<span class="n">alpha</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># The strength of the Coulomb interaction</span>
<span class="n">a</span> <span class="o">=</span> <span class="mf">0.25</span>  <span class="c1"># The shielding parameter in the Coulomb interaction potential</span>

<span class="n">omega</span> <span class="o">=</span> <span class="mf">0.25</span>  <span class="c1"># The frequency of the harmonic oscillator trap</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 3;
                var nbb_unformatted_code = "l = 10  # Number of eigenstates\ngrid_length = 10  # The width of the one-dimensional grid\nnum_grid_points = 2001  # The number of discretized points on the grid.\n# More points give better results for the single-particle basis at the cost of slower setup.\n\nalpha = 1  # The strength of the Coulomb interaction\na = 0.25  # The shielding parameter in the Coulomb interaction potential\n\nomega = 0.25  # The frequency of the harmonic oscillator trap";
                var nbb_formatted_code = "l = 10  # Number of eigenstates\ngrid_length = 10  # The width of the one-dimensional grid\nnum_grid_points = 2001  # The number of discretized points on the grid.\n# More points give better results for the single-particle basis at the cost of slower setup.\n\nalpha = 1  # The strength of the Coulomb interaction\na = 0.25  # The shielding parameter in the Coulomb interaction potential\n\nomega = 0.25  # The frequency of the harmonic oscillator trap";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">potential</span> <span class="o">=</span> <span class="n">ODQD</span><span class="o">.</span><span class="n">HOPotential</span><span class="p">(</span><span class="n">omega</span><span class="o">=</span><span class="n">omega</span><span class="p">)</span>  <span class="c1"># Harmonic oscillator potential</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 4;
                var nbb_unformatted_code = "potential = ODQD.HOPotential(omega=omega)  # Harmonic oscillator potential";
                var nbb_formatted_code = "potential = ODQD.HOPotential(omega=omega)  # Harmonic oscillator potential";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<p>For examples on how to create your own potential see here: https://github.com/Schoyen/quantum-systems/blob/master/quantum_systems/quantum_dots/one_dim/one_dim_potentials.py</p>
<p>Below we construct the basis set.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">odqd</span> <span class="o">=</span> <span class="n">ODQD</span><span class="p">(</span>
    <span class="n">l</span><span class="o">=</span><span class="n">l</span><span class="p">,</span>
    <span class="n">grid_length</span><span class="o">=</span><span class="n">grid_length</span><span class="p">,</span>
    <span class="n">num_grid_points</span><span class="o">=</span><span class="n">num_grid_points</span><span class="p">,</span>
    <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
    <span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span>
    <span class="n">potential</span><span class="o">=</span><span class="n">potential</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 5;
                var nbb_unformatted_code = "odqd = ODQD(\n    l=l,\n    grid_length=grid_length,\n    num_grid_points=num_grid_points,\n    alpha=alpha,\n    a=a,\n    potential=potential,\n)";
                var nbb_formatted_code = "odqd = ODQD(\n    l=l,\n    grid_length=grid_length,\n    num_grid_points=num_grid_points,\n    alpha=alpha,\n    a=a,\n    potential=potential,\n)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<p>The listed matrix elements can now be found from <code class="docutils literal notranslate"><span class="pre">odqd</span></code>.</p>
<ol class="simple">
<li><p>The one-body Hamiltonian <span class="math notranslate nohighlight">\(h_{\alpha \beta}\)</span> are found in <code class="docutils literal notranslate"><span class="pre">odqd.h</span></code>.</p></li>
<li><p>The two-body Coulomb interaction matrix elements <span class="math notranslate nohighlight">\(u^{\alpha \beta}_{\gamma \delta}\)</span> are found in <code class="docutils literal notranslate"><span class="pre">odqd.u</span></code>.</p></li>
<li><p>The one-body position matrix elements <span class="math notranslate nohighlight">\(x_{\alpha \beta}\)</span> are found in <code class="docutils literal notranslate"><span class="pre">odqd.position[0]</span></code>, where the index <code class="docutils literal notranslate"><span class="pre">0</span></code> is included in case of higher-dimensional systems. In our case there is only the one and <code class="docutils literal notranslate"><span class="pre">odqd.position.shape</span> <span class="pre">==</span> <span class="pre">(1,</span> <span class="pre">odqd.l,</span> <span class="pre">odqd.l)</span></code>.</p></li>
<li><p>The evaluated (evaluated at the grid) single-particle functions <span class="math notranslate nohighlight">\(\chi_{\alpha}(x)\)</span> are found in <code class="docutils literal notranslate"><span class="pre">odqd.spf</span></code>, where <code class="docutils literal notranslate"><span class="pre">odqd.spf.shape</span> <span class="pre">==</span> <span class="pre">(odqd.l,</span> <span class="pre">num_grid_points)</span></code>. That is, the ground state harmonic oscillator single-particle function is found from <code class="docutils literal notranslate"><span class="pre">odqd.spf[0]</span></code>.</p></li>
<li><p>The discretized grid can be accessed from <code class="docutils literal notranslate"><span class="pre">odqd.grid</span></code>.</p></li>
</ol>
<p>Note that all matrix elements and basis functions are inherently complex with the imaginary part being zero.
The ground-state solutions will be real, but when we include time-evolution everything will become complex and to avoid problems with data types when using NumPy we start of with complex matrix elements.</p>
</div>
<div class="section" id="plotting-the-basis-elements">
<h3>Plotting the basis elements<a class="headerlink" href="#plotting-the-basis-elements" title="Permalink to this headline">¶</a></h3>
<p>Below we demonstrate how the single-particle functions can be plotted on the grid along with the harmonic oscillator potential.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">odqd</span><span class="o">.</span><span class="n">grid</span><span class="p">,</span> <span class="n">potential</span><span class="p">(</span><span class="n">odqd</span><span class="o">.</span><span class="n">grid</span><span class="p">))</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">l</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">odqd</span><span class="o">.</span><span class="n">grid</span><span class="p">,</span>
        <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">odqd</span><span class="o">.</span><span class="n">spf</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">odqd</span><span class="o">.</span><span class="n">h</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">real</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$\chi_{&quot;</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="sa">r</span><span class="s2">&quot;}$&quot;</span><span class="p">,</span>
    <span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/task-1-single-particle-basis_12_0.png" src="_images/task-1-single-particle-basis_12_0.png" />
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 6;
                var nbb_unformatted_code = "fig = plt.figure(figsize=(16, 10))\n\nplt.plot(odqd.grid, potential(odqd.grid))\n\nfor i in range(l):\n    plt.plot(\n        odqd.grid,\n        np.abs(odqd.spf[i]) ** 2 + odqd.h[i, i].real,\n        label=r\"$\\chi_{\" + f\"{i}\" + r\"}$\",\n    )\n\nplt.grid()\nplt.legend()\nplt.show()";
                var nbb_formatted_code = "fig = plt.figure(figsize=(16, 10))\n\nplt.plot(odqd.grid, potential(odqd.grid))\n\nfor i in range(l):\n    plt.plot(\n        odqd.grid,\n        np.abs(odqd.spf[i]) ** 2 + odqd.h[i, i].real,\n        label=r\"$\\chi_{\" + f\"{i}\" + r\"}$\",\n    )\n\nplt.grid()\nplt.legend()\nplt.show()";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
</div>
</div>
<div class="section" id="types-of-orbital-systems">
<h2>Types of orbital systems<a class="headerlink" href="#types-of-orbital-systems" title="Permalink to this headline">¶</a></h2>
<p>In quantum chemistry it is common to call the initial single-particle functions for <em>atomic orbitals</em> (AO).
We will also adhere to this convention, thus making the basis of harmonic oscillator single-particle functions the atomic orbitals of our system.
Now, as the harmonic oscillator Hamiltonian is independent of spin we have restricted our view to the spatial part of the atomic orbitals when using quantum-systems to construct our basis elements.
However, when moving to the full fermionic many-body picture (two = many) we have to include spin to get the full picture.
We often talk about three kinds of orbitals depending on the restrictions put on spin.</p>
<ol>
<li><p>The general spin-orbital is on the form</p>
<div class="amsmath math notranslate nohighlight" id="equation-02d2db5e-3cdc-41ad-862c-d399d6bb0776">
<span class="eqno">(5)<a class="headerlink" href="#equation-02d2db5e-3cdc-41ad-862c-d399d6bb0776" title="Permalink to this equation">¶</a></span>\[\begin{align}
        \phi(x, m_s)
        &amp;= \varphi_1(x) \alpha(m_s) + \varphi_2(x) \beta(m_s),
    \end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(\varphi_i(x)\)</span> are the spatial oribtals, and <span class="math notranslate nohighlight">\(\sigma \in \{\alpha, \beta\}\)</span> are spin basis functions with <span class="math notranslate nohighlight">\(m_s \in \{\uparrow, \downarrow\}\)</span> the spin quantum number.
Typical choices for the spin basis functions are</p>
<div class="amsmath math notranslate nohighlight" id="equation-55910ea7-20e9-4fe7-976f-d921b6c2e39c">
<span class="eqno">(6)<a class="headerlink" href="#equation-55910ea7-20e9-4fe7-976f-d921b6c2e39c" title="Permalink to this equation">¶</a></span>\[\begin{gather}
        \alpha(\uparrow) = 1, \quad \beta(\uparrow) = 0, \\
        \alpha(\downarrow) = 0, \quad \beta(\downarrow) = 1.
    \end{gather}\]</div>
</li>
<li><p>The unrestricted spin-orbital is on the form</p>
<div class="amsmath math notranslate nohighlight" id="equation-9e53898f-4902-4999-93e4-eacc4fd139fc">
<span class="eqno">(7)<a class="headerlink" href="#equation-9e53898f-4902-4999-93e4-eacc4fd139fc" title="Permalink to this equation">¶</a></span>\[\begin{align}
        \phi(x, m_s)
        = \varphi_{\sigma}(x) \sigma(m_s),
    \end{align}\]</div>
<p>where an unrestricted spin-orbital has a definite spin-direction (either <span class="math notranslate nohighlight">\(\alpha\)</span> or <span class="math notranslate nohighlight">\(\beta\)</span>), but allows for the spatial part to be different between spin-directions.</p>
</li>
<li><p>The restricted spin-orbital is on the form</p>
<div class="amsmath math notranslate nohighlight" id="equation-fd6c8805-161d-4af9-b04e-8b49bfb2d758">
<span class="eqno">(8)<a class="headerlink" href="#equation-fd6c8805-161d-4af9-b04e-8b49bfb2d758" title="Permalink to this equation">¶</a></span>\[\begin{align}
        \phi(x, m_s)
        = \varphi(x) \sigma(m_s),
    \end{align}\]</div>
<p>where the spin-orbitals have a definite spin-direction with the spatial part equal between the two spin-directions.</p>
</li>
</ol>
<p>We will in this project create a general Hartree-Fock (GHF) solver which implies that we use general spin-orbitals.
This will turn out to be easiest mathematically (when deriving the equations for GHF) and the most general formulation.
However, the restricted and unrestricted formulations are more numerically efficient.</p>
</div>
<div class="section" id="adding-spin-to-the-harmonic-oscillator-basis">
<h2>Adding spin to the harmonic oscillator basis<a class="headerlink" href="#adding-spin-to-the-harmonic-oscillator-basis" title="Permalink to this headline">¶</a></h2>
<p>We have constructed a spatial basis of harmonic oscillator eigenstates <span class="math notranslate nohighlight">\(\{\chi_{\alpha}\}_{\alpha = 1}^{l}\)</span>, with spin-independent matrix elements <span class="math notranslate nohighlight">\(h_{\alpha \beta}\)</span>, <span class="math notranslate nohighlight">\(u^{\alpha \beta}_{\gamma \delta}\)</span>, etc, as described <a class="reference internal" href="#task-1-mel"><span class="std std-ref">above</span></a>.
We now wish to include spin in the harmonic oscillator basis functions.
The way we do this is by doubling each spatial basis function (and hence each axis in the matrix elements) essentially creating duplicates.</p>
<p>We will denote this basis of general harmonic oscillator spin-orbitals by <span class="math notranslate nohighlight">\(\{\psi_{\mu}\}_{\mu = 1}^{2l}\)</span>.
The question is then how we can go from <span class="math notranslate nohighlight">\(h_{\alpha \beta} \to h_{\mu \nu}\)</span> and similarly for the other matrix elements.
We let the general harmonic oscillator spin-orbitals be given by</p>
<div class="amsmath math notranslate nohighlight" id="equation-8f8df905-423e-4131-a32c-9f9b6fe6ad13">
<span class="eqno">(9)<a class="headerlink" href="#equation-8f8df905-423e-4131-a32c-9f9b6fe6ad13" title="Permalink to this equation">¶</a></span>\[\begin{align}
    |\psi_{\mu}\rangle
    &amp;= |\chi_{\alpha}\rangle \otimes |\sigma\rangle,
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(\alpha = \mu // 2\)</span> (integer division), and <span class="math notranslate nohighlight">\(\sigma = \alpha\)</span> if <span class="math notranslate nohighlight">\(\mu\)</span> is even and <span class="math notranslate nohighlight">\(\sigma = \beta\)</span> if <span class="math notranslate nohighlight">\(\mu\)</span> is odd.
The one-body Hamiltonian matrix elements are thus given by</p>
<div class="amsmath math notranslate nohighlight" id="equation-4cc12d2f-d5d3-41e3-8f41-b497d6bcc45a">
<span class="eqno">(10)<a class="headerlink" href="#equation-4cc12d2f-d5d3-41e3-8f41-b497d6bcc45a" title="Permalink to this equation">¶</a></span>\[\begin{align}
    h_{\mu \nu}
    &amp;= \langle \psi_{\mu} | \hat{h} \otimes \hat{I} | \psi_{\nu} \rangle
    = \left(\langle \chi_{\alpha} | \otimes \langle \sigma | \right)
    \hat{h} \otimes \hat{I} \left( | \chi_{\beta} \rangle \otimes | \tau \rangle \right)
    \\
    &amp;= \langle \chi_{\alpha} | \hat{h} | \chi_{\beta} \rangle
    \langle \sigma | \tau \rangle
    = h_{\alpha \beta} \delta_{\sigma \tau},
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(\hat{I}\)</span> is the spin-basis identity operator, and we’ve chosen an orthonormal basis of spin states.
The full general spin-orbital matrix <span class="math notranslate nohighlight">\(\mathbf{h}_{GSO}\)</span> can then be constructed from the (spatial) atomic orbital matrix <span class="math notranslate nohighlight">\(\mathbf{h}_{SpaS}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{I}_{2\times 2}\)</span> the <span class="math notranslate nohighlight">\(2 \times 2\)</span> identity matrix by</p>
<div class="amsmath math notranslate nohighlight" id="equation-243483fa-8544-4961-b720-3d12ab264ac8">
<span class="eqno">(11)<a class="headerlink" href="#equation-243483fa-8544-4961-b720-3d12ab264ac8" title="Permalink to this equation">¶</a></span>\[\begin{align}
    \mathbf{h}_{GSO} = \mathbf{h}_{SpaS} \otimes \mathbf{I}_{2 \times 2},
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(\otimes\)</span> is the Kronecker product.
This ensures that all even (odd) indices correspond to <span class="math notranslate nohighlight">\(\alpha\)</span> (<span class="math notranslate nohighlight">\(\beta\)</span>) spin-states.
From <a class="reference external" href="https://github.com/Schoyen/quantum-systems">quantum-systems</a> this is done automatically when passing in a <code class="docutils literal notranslate"><span class="pre">BasisSet</span></code> to the class <code class="docutils literal notranslate"><span class="pre">GeneralOrbitalSystem</span></code>.
Below we demonstrate how this is done for harmonic oscillator basis set.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Basis l: </span><span class="si">{</span><span class="n">odqd</span><span class="o">.</span><span class="n">l</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Basis grid: </span><span class="si">{</span><span class="n">odqd</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Basis h.shape: </span><span class="si">{</span><span class="n">odqd</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Basis u.shape: </span><span class="si">{</span><span class="n">odqd</span><span class="o">.</span><span class="n">u</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Basis x.shape: </span><span class="si">{</span><span class="n">odqd</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Basis spf.shape: </span><span class="si">{</span><span class="n">odqd</span><span class="o">.</span><span class="n">spf</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Basis l: 10
Basis grid: (2001,)
Basis h.shape: (10, 10)
Basis u.shape: (10, 10, 10, 10)
Basis x.shape: (1, 10, 10)
Basis spf.shape: (10, 2001)
</pre></div>
</div>
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 7;
                var nbb_unformatted_code = "print(f\"Basis l: {odqd.l}\")\nprint(f\"Basis grid: {odqd.grid.shape}\")\nprint(f\"Basis h.shape: {odqd.h.shape}\")\nprint(f\"Basis u.shape: {odqd.u.shape}\")\nprint(f\"Basis x.shape: {odqd.position.shape}\")\nprint(f\"Basis spf.shape: {odqd.spf.shape}\")";
                var nbb_formatted_code = "print(f\"Basis l: {odqd.l}\")\nprint(f\"Basis grid: {odqd.grid.shape}\")\nprint(f\"Basis h.shape: {odqd.h.shape}\")\nprint(f\"Basis u.shape: {odqd.u.shape}\")\nprint(f\"Basis x.shape: {odqd.position.shape}\")\nprint(f\"Basis spf.shape: {odqd.spf.shape}\")";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">2</span>  <span class="c1"># Number of particles</span>

<span class="c1"># This adds spin to all matrix elements</span>
<span class="c1"># Note that gos.l = 2 * l</span>
<span class="c1"># Note also that odqd itself is transformed into a general orbital system.</span>
<span class="c1"># If you want to keep the pure spatial basis you can pass in a copy, viz.</span>
<span class="c1"># gos = GeneralOrbitalSystem(n, gos.copy_basis())</span>
<span class="n">gos</span> <span class="o">=</span> <span class="n">GeneralOrbitalSystem</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">odqd</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;GOS l: </span><span class="si">{</span><span class="n">gos</span><span class="o">.</span><span class="n">l</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;GOS grid: </span><span class="si">{</span><span class="n">gos</span><span class="o">.</span><span class="n">_basis_set</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;GOS h.shape: </span><span class="si">{</span><span class="n">gos</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;GOS u.shape: </span><span class="si">{</span><span class="n">gos</span><span class="o">.</span><span class="n">u</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;GOS x.shape: </span><span class="si">{</span><span class="n">gos</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;GOS spf.shape: </span><span class="si">{</span><span class="n">gos</span><span class="o">.</span><span class="n">spf</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>GOS l: 20
GOS grid: (2001,)
GOS h.shape: (20, 20)
GOS u.shape: (20, 20, 20, 20)
GOS x.shape: (1, 20, 20)
GOS spf.shape: (20, 2001)
</pre></div>
</div>
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 8;
                var nbb_unformatted_code = "n = 2  # Number of particles\n\n# This adds spin to all matrix elements\n# Note that gos.l = 2 * l\n# Note also that odqd itself is transformed into a general orbital system.\n# If you want to keep the pure spatial basis you can pass in a copy, viz.\n# gos = GeneralOrbitalSystem(n, gos.copy_basis())\ngos = GeneralOrbitalSystem(n, odqd)\n\nprint(f\"GOS l: {gos.l}\")\nprint(f\"GOS grid: {gos._basis_set.grid.shape}\")\nprint(f\"GOS h.shape: {gos.h.shape}\")\nprint(f\"GOS u.shape: {gos.u.shape}\")\nprint(f\"GOS x.shape: {gos.position.shape}\")\nprint(f\"GOS spf.shape: {gos.spf.shape}\")";
                var nbb_formatted_code = "n = 2  # Number of particles\n\n# This adds spin to all matrix elements\n# Note that gos.l = 2 * l\n# Note also that odqd itself is transformed into a general orbital system.\n# If you want to keep the pure spatial basis you can pass in a copy, viz.\n# gos = GeneralOrbitalSystem(n, gos.copy_basis())\ngos = GeneralOrbitalSystem(n, odqd)\n\nprint(f\"GOS l: {gos.l}\")\nprint(f\"GOS grid: {gos._basis_set.grid.shape}\")\nprint(f\"GOS h.shape: {gos.h.shape}\")\nprint(f\"GOS u.shape: {gos.u.shape}\")\nprint(f\"GOS x.shape: {gos.position.shape}\")\nprint(f\"GOS spf.shape: {gos.spf.shape}\")";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<p>Looking at the output above we see that the number of basis elements <span class="math notranslate nohighlight">\(l\)</span> have been doubled.
However, the grid and the number of dimensions (the first axis in <code class="docutils literal notranslate"><span class="pre">gos.position</span></code>) are unchanged.
It is worth pointing out that <code class="docutils literal notranslate"><span class="pre">gos.spf[::2]</span></code> (all even indices) correspond to the spatial part of the <span class="math notranslate nohighlight">\(\alpha\)</span> component of a general spin-orbital and <code class="docutils literal notranslate"><span class="pre">gos.spf[1::2]</span></code> (all odd indices) the <span class="math notranslate nohighlight">\(\beta\)</span> component.</p>
<div class="section" id="anti-symmetric-two-body-elements">
<h3>Anti-symmetric two-body elements<a class="headerlink" href="#anti-symmetric-two-body-elements" title="Permalink to this headline">¶</a></h3>
<p>When using general orbitals we often work with the anti-symmetric Coulomb elements.
These are defined to be</p>
<div class="amsmath math notranslate nohighlight" id="equation-2e985515-ff3f-488d-bb9d-cf57a7ee562d">
<span class="eqno">(12)<a class="headerlink" href="#equation-2e985515-ff3f-488d-bb9d-cf57a7ee562d" title="Permalink to this equation">¶</a></span>\[\begin{align}
    u^{\mu \nu}_{\kappa \lambda}
    = \langle \psi_{\mu} \psi_{\nu} | \hat{u} | \psi_{\kappa} \psi_{\lambda} \rangle_{AS}
    \equiv
    \langle \psi_{\mu} \psi_{\nu} | \hat{u} | \psi_{\kappa} \psi_{\lambda} \rangle
    -
    \langle \psi_{\mu} \psi_{\nu} | \hat{u} | \psi_{\lambda} \psi_{\kappa} \rangle,
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(u^{\mu \nu}_{\kappa \lambda}\)</span> will be interpreted as the anti-symmetric two-body elements when using <code class="docutils literal notranslate"><span class="pre">GeneralOrbitalSystem</span></code> (this is the default behavior, however <code class="docutils literal notranslate"><span class="pre">gos</span> <span class="pre">=</span> <span class="pre">GeneralOrbitalSystem(n,</span> <span class="pre">odqd,</span> <span class="pre">anti_symmetrize=False)</span></code> will not make <code class="docutils literal notranslate"><span class="pre">gos.u</span></code> anti-symmetric).</p>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="intro.html" title="previous page">Time-dependent Hartree-Fock theory</a>
    <a class='right-next' id="next-link" href="task-2-ghf-solver.html" title="next page">Task 2: General Hartree-Fock solver</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Øyvind Sigmundson Schøyen<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  None
  </body>
</html>